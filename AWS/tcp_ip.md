# TCP/IPの入門

## 目次
- [プロトコル](#プロトコル)
- [IP](#IP)

## プロトコル
### プロトコルとは
一言で言うと、コンピュータとコンピュータがネットワークを利用して通信するために決められた「約束ごと」。  

会話に置き換えると、プロトコルは「言語」のようなもの。  
日本語の"ルール"を知ってる人同士が会話をするから、コミュニケーションが成り立つのと同じ。

わかりやすい例としては、モールス信号がある。  
ONかOFF（1か0か）（電気が流れてるか止まってるか）でしか表現できない状態で、会話をするには共通のルールを作ってしまえば良い。

| アルファベット | 信号 |
|---|---|
| "A" | . _ |
| "B" | _ . . . |
| "C" | _ . _ . |

これが「通信プロトコル」と呼ばれるもの。  
基本的には、やりたいことが「英語での会話」の場合、アルファベットを信号に置き換えるルールがあれば良いし、  
「数字を伝える」だけの場合、2進数のルールを用意すれば良い。  
このように、やりたいことができる最低限のルールを、やりたいこと毎に作っていけば良い。  

なので、通信プロトコルも用途やレイヤーごとにたくさん存在する。  

### プロトコルの例

| アーキテクチャ | プロトコル | 用途など |
|---|---|---|
| TCP/IP | IP, TCP, UDP, HTTP, HTTPS, TELNET, SMTP, ... | インターネット, LAN |
| IPX/SPX | IPX, SPX, NPC, ... | パソコンLAN |

## IP
IPは、TCP/IPアーキテクチャにおけるIPレイヤーのプロトコル。  

### IPアドレス
IPアドレスは、ネットワークレイヤー上で通信相手の識別のために使われるアドレス。  
「ネットワークに接続されている全てのホストの中から、通信を行う宛先を識別する」ために使われる。  

<img src="./assets/IMG_2530.png" width="600">

### ルーティング
IPアドレスは、ルーターを経由して、最終目的地までたどり着く。  
<img src="./assets/IMG_2531.png" width="600">
<img src="./assets/IMG_2532.png" width="600">

### IPアドレスの基礎知識
IPアドレス（IPv4）は32ビットの整数値で表現される。  
この32ビットを8ビットずつの4つの組に分けて、それぞれを10進数で表す。  

| 172.20.1.1 | 2<sup>8</sup> | 2<sup>8</sup> | 2<sup>8</sup> | 2<sup>8</sup> |
|---|---|---|---|---|
| 2進数 | 1010110010101100 | 0001010000010100 | 0000000100000001 | 0000000100000001 |
| 10進数 | 172 | 20 | 1 | 1 |

つまり、IPアドレスで表すことができるホストの数は、  
2<sup>32</sup> = 4,294,967,296  

### ネットワーク部とホスト部
IPアドレスは「ネットワーク部」と「ホスト部」に分かれる。  
- 同一サブネットワーク内では、必ずネットワーク部が同じでないといけない。  
- 同一サブネットワーク内では、必ずホスト部が異なってないといけない。

この二つの制約の元、各ホストはIPアドレスを振り分けられる。  

<img src="./assets/IMG_2534.png" width="600">

### サブネットマスク
IPアドレスの先頭何ビットがネットワーク部かを表しているのがサブネットマスク。  

#### *192.168.128.10 `/24`*
となっていれば、先頭の24bit分（つまり192.168.128まで）がネットワーク部と言う事になる。  
つまり、このサブネット内の全てのホストは、必ず共通の`192.168.128`というネットワーク部を持つIPアドレスが割り振られていることがわかる。  

### グローバルアドレスとプライベートアドレス
インターネット上でIPアドレスは一意でないといけなかった。  
つまり、同じIPアドレスを持つホストが複数存在してはいけない。 
IPアドレスの数に限界が来てしまう。  
そこで、インターネットに接続されていない、個々ネットワーク内でのみ使えるプライベートアドレスが誕生した。  
このプライベートアドレスは、個々のネットワーク内で一意であれば、グルーバルで被っていても問題ない。  

逆に、プライベートアドレスであることが分かるように、以下のアドレスがグローバルアドレスとして使用不可になった。  

| クラス | サブネット | プライベートアドレス範囲 |
|---|---|---|
| クラスA | 10.0.0.0/8 | 10.0.0.0 〜 10.255.255.255 |
| クラスB | 172.16.0.0/12 | 712.16.0.0 〜 172.31.255.255 |
| クラスC | 192.168.0.0/16 | 192.168.0.0 〜 192.168.255.255 |


